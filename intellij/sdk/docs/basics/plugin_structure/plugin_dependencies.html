


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>Plugin Dependencies / IntelliJ Platform SDK  DevGuide</title>
    <link rel="stylesheet" href="/intellij/sdk/docs/app/app.css">
    <link rel="shortcut icon" href="/intellij/sdk/docs/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="57x57" href="/intellij/sdk/docs/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/intellij/sdk/docs/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/intellij/sdk/docs/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/intellij/sdk/docs/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/intellij/sdk/docs/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/intellij/sdk/docs/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/intellij/sdk/docs/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/intellij/sdk/docs/apple-touch-icon-180x180.png">
    <link rel="mask-icon" href="/intellij/sdk/docs/apple-mask-icon.svg" color="black">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-square70x70logo" content="/intellij/sdk/docs/mstile-70x70.png">
    <meta name="msapplication-TileImage" content="/intellij/sdk/docs/mstile-144x144.png">
    <meta name="msapplication-square150x150logo" content="/intellij/sdk/docs/mstile-150x150.png">
    <meta name="msapplication-wide310x150logo" content="/intellij/sdk/docs/mstile-310x150.png">
    <meta name="msapplication-square310x310logo" content="/intellij/sdk/docs/mstile-310x310.png">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="Documentation for working with and extending the IntelliJ Platform SDK" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://intellij-sdk-docs-cn.github.io/intellij/sdk/docs//basics/plugin_structure/plugin_dependencies.html" />
    <meta property="og:site_name" content="JetBrains IntelliJ Platform SDK" />
    <meta property="og:title" content="Plugin Dependencies" />
    <meta property="og:description" content="Documentation for working with and extending the IntelliJ Platform SDK" />
    <meta property="og:image" content="https://intellij-sdk-docs-cn.github.io/intellij/sdk/docs/jetbrains.png" />
    <meta property="article:modified_time" content="2020-03-25T18:03:10+08:00" />
    <!-- <meta property="article:section" content="" /> 
    <meta property="article:tag" content="" /> -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@JBPlatform" />
    <meta name="twitter:title" content="Plugin Dependencies" />
    <meta name="twitter:description" content="Documentation for working with and extending the IntelliJ Platform SDK" />
    <meta name="twitter:image" content="https://intellij-sdk-docs-cn.github.io/intellij/sdk/docs/jetbrains.png" />
    <meta class="swiftype" name="product" data-type="string" content="/intellij/sdk/docs/"></meta>
<link  rel="stylesheet" href="/intellij/sdk/docs/app/styles.css"></head>
<body data-id="basics/plugin_structure/plugin_dependencies">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search IntelliJ Platform SDK  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a data-bypass="true" href="//youtrack.jetbrains.com/issues/IJSDK">Send feedback</a></p>
                <p>&copy; 2000&ndash;2020 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>IntelliJ Platform SDK DevGuide</h3>
                
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">
                    <div class="navigation-links _top" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/basics/plugin_structure/plugin_icon_file.html">Plugin Logo</a>
                        
                    </div>
                    <a data-bypass="true" href="https://github.com/intellij-sdk-docs-cn/intellij-sdk-docs-cn/edit/master/basics/plugin_structure/plugin_dependencies.md" class="page-link-to-github" target="_blank" title="Edit this page on GitHub">
                        <i class="github-icon"></i>
                        <span class="text">Edit page</span>
                    </a>

                    <h1>Plugin Dependencies</h1>
                    <!-- Copyright 2000-2020 JetBrains s.r.o. and other contributors. Use of this source code is governed by the Apache 2.0 license that can be found in the LICENSE file. -->

<p>A plugin may depend on classes from other plugins, either bundled, third-party, or by the same author.
This document describes the syntax for declaring plugin dependencies and optional plugin dependencies.
For more information about dependencies on the IntelliJ Platform modules, see Part II of this document: <a href="/intellij/sdk/docs/basics/getting_started/plugin_compatibility.html"><span>Plugin Compatibility with IntelliJ Platform Products</span></a>.</p>

<aside class="note">
  <p> It is not possible to specify the minimum/maximum version for the dependent plugin. (<a href="https://youtrack.jetbrains.com/issue/IDEABKL-7906" data-bypass="yes" target="_blank"><span>Issue</span></a>)</p>
</aside>

<p>To express dependencies on classes from other plugins or modules, perform the following three required steps:</p>

<a name="preparing-sandbox" class="elem-anchor"></a>
<h2>1. Preparing Sandbox<a href="#preparing-sandbox" class="anchor-link"><span></span></a></h2>
<p>If the plugin is not bundled with the target IDE, run the (sandbox) <a href="/intellij/sdk/docs/basics/ide_development_instance.html"><span>IDE Development Instance</span></a> of your target IDE and install the plugin there.</p>

<a name="project-setup" class="elem-anchor"></a>
<h2>2. Project Setup<a href="#project-setup" class="anchor-link"><span></span></a></h2>
<p>Depending on the chosen development workflow (Gradle or DevKit), one of the two following steps is necessary.</p>

<a name="gradle" class="elem-anchor"></a>
<h3>2.1 Gradle<a href="#gradle" class="anchor-link"><span></span></a></h3>
<aside class="note">
  <p> Please see the <code class="code highlight language-text">plugins</code> attribute <a href="https://github.com/JetBrains/gradle-intellij-plugin#configuration" data-bypass="yes" target="_blank"><span>gradle-intellij-plugin: Configuration</span></a> for acceptable values.</p>
</aside>

<p>If the project is using <a href="/intellij/sdk/docs/tutorials/build_system.html"><span>Gradle</span></a> with a Groovy build script to build the plugin, add the dependency to the <code class="code highlight language-text">plugins</code> parameter of the <code class="code highlight language-text">intellij</code> block in your build.gradle, for example:</p>

<div class="code-block" data-lang="groovy"><code class="code-block__wrapper"><span class="n">intellij</span> <span class="o">{</span>
    <span class="n">plugins</span> <span class="s1">'org.jetbrains.kotlin:1.3.11-release-IJ2018.3-1'</span>
<span class="o">}</span>
</code></div>

<p>If the project is using <a href="/intellij/sdk/docs/tutorials/build_system.html"><span>Gradle</span></a> with a Kotlin build script to build the plugin, use <code class="code highlight language-text">setPlugins()</code> within the <code class="code highlight language-text">intellij</code> block, for example:</p>

<div class="code-block" data-lang="kotlin"><code class="code-block__wrapper"><span class="n">intellij</span> <span class="p">{</span>
        <span class="n">setPlugins</span><span class="p">(</span><span class="s">"org.jetbrains.kotlin:1.3.11-release-IJ2018.3-1"</span><span class="p">)</span>
<span class="p">}</span>
</code></div>

<aside class="note">
  <p> Transitive dependencies required for tests must currently be <a href="https://github.com/JetBrains/gradle-intellij-plugin/issues/38" data-bypass="yes" target="_blank"><span>specified explicitly</span></a>.</p>
</aside>

<a name="devkit" class="elem-anchor"></a>
<h4>2.2 DevKit</h4>
<p>If the project is using <a href="/intellij/sdk/docs/basics/getting_started/using_dev_kit.html"><span>DevKit</span></a>, add the JARs of the plugin on which the project depends to the <strong>classpath</strong> of the <em>IntelliJ Platform SDK</em>.</p>

<aside class="warning">
  <p> Do not add the plugin JARs as a library: this will fail at runtime because the IntelliJ Platform will load two separate copies of the dependency plugin classes.</p>
</aside>

<p>To do that, open the Project Structure dialog, select the SDK used in the project, press the + button in the Classpath tab, and
select the plugin JAR file or files:</p>
<ul>
  <li>For bundled plugins, the plugin JAR files are located in <code class="code highlight language-text">plugins/&lt;pluginname&gt;</code> or <code class="code highlight language-text">plugins/&lt;pluginname&gt;/lib</code> under the main installation directory.
If you’re not sure which JAR to add, you can add all of them.</li>
  <li>For non-bundled plugins, the plugin JAR files are located in <code class="code highlight language-text">config/plugins/&lt;pluginname&gt;</code> or <code class="code highlight language-text">config/plugins/&lt;pluginname&gt;/lib</code> under the directory specified as “Sandbox Home” in the IntelliJ Platform Plugin SDK settings.</li>
</ul>

<p><img src="img/add_plugin_dependency.png" alt="Adding Plugin to Classpath" /></p>

<a name="dependency-declaration-in-pluginxml" class="elem-anchor"></a>
<h2>3. Dependency Declaration in plugin.xml<a href="#dependency-declaration-in-pluginxml" class="anchor-link"><span></span></a></h2>
<p>Regardless of whether a plugin project uses <a href="/intellij/sdk/docs/basics/getting_started/plugin_compatibility.html#modules-available-in-all-products"><span>Modules Available in All Products</span></a>, or <a href="/intellij/sdk/docs/basics/getting_started/plugin_compatibility.html#modules-specific-to-functionality"><span>Modules Specific to Functionality</span></a>, the correct module must be listed as a dependency in <code class="code highlight language-text">plugin.xml</code>. 
If a project depends on another plugin, the dependency must be declared like a module.
If only general IntelliJ Platform features (APIs) are used, then a default dependency on <code class="code highlight language-text">com.intellij.modules.platform</code> must be declared.
To display a list of available IntelliJ Platform modules, invoke the <a href="https://www.jetbrains.com/help/idea/auto-completing-code.html#4eac28ba" data-bypass="yes" target="_blank"><span>code completion</span></a> feature for the <code class="code highlight language-text">&lt;depends&gt;</code> element contents while editing the plugin project’s <code class="code highlight language-text">plugin.xml</code> file.</p>

<a name="configuring-pluginxml" class="elem-anchor"></a>
<h3>3.1 Configuring plugin.xml<a href="#configuring-pluginxml" class="anchor-link"><span></span></a></h3>
<p>In the <code class="code highlight language-text">plugin.xml</code>, add a <code class="code highlight language-text">&lt;depends&gt;</code> tag with the ID of the dependency plugin as its content.
Continuing with the example from <a href="#2-project-setup"><span>Section 2</span></a> above, the dependency declaration in <code class="code highlight language-text">plugin.xml</code> would be:</p>
<div class="code-block" data-lang="xml"><code class="code-block__wrapper"><span class="nt">&lt;depends&gt;</span>org.jetbrains.kotlin<span class="nt">&lt;/depends&gt;</span>
</code></div>

<a name="optional-plugin-dependencies" class="elem-anchor"></a>
<h2>Optional Plugin Dependencies<a href="#optional-plugin-dependencies" class="anchor-link"><span></span></a></h2>
<p>A project can also specify an optional plugin dependency. In this case, the plugin will load even if the plugin it depends on
is not installed or enabled, but part of the functionality of the plugin will not be available. In order to do that,
add <code class="code highlight language-text">optional="true" config-file="otherconfig.xml"</code> to the <code class="code highlight language-text">&lt;depends&gt;</code> tag.</p>

<p>For example, if a plugin project adds additional highlighting for Java and Kotlin files, use the following setup. 
The main <code class="code highlight language-text">plugin.xml</code> will define an annotator for Java and specify an optional dependency on the Kotlin plugin:</p>
<div class="code-block" data-lang="xml"><code class="code-block__wrapper"><span class="nt">&lt;idea-plugin&gt;</span>
   ...
   <span class="nt">&lt;depends</span> <span class="na">optional=</span><span class="s">"true"</span> <span class="na">config-file=</span><span class="s">"withKotlin.xml"</span><span class="nt">&gt;</span>org.jetbrains.kotlin<span class="nt">&lt;/depends&gt;</span>

   <span class="nt">&lt;extensions</span> <span class="na">defaultExtensionNs=</span><span class="s">"com.intellij"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;annotator</span> <span class="na">language=</span><span class="s">"JAVA"</span> <span class="na">implementationClass=</span><span class="s">"com.example.MyJavaAnnotator"</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;/extensions&gt;</span>
<span class="nt">&lt;/idea-plugin&gt;</span>
</code></div>

<p>Then create a file called <code class="code highlight language-text">withKotlin.xml</code>, in the same directory as the main <code class="code highlight language-text">plugin.xml</code> file. In that file, define an annotator for Kotlin:</p>
<div class="code-block" data-lang="xml"><code class="code-block__wrapper"><span class="nt">&lt;idea-plugin&gt;</span>
   <span class="nt">&lt;extensions</span> <span class="na">defaultExtensionNs=</span><span class="s">"com.intellij"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;annotator</span> <span class="na">language=</span><span class="s">"kotlin"</span> <span class="na">implementationClass=</span><span class="s">"com.example.MyKotlinAnnotator"</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;/extensions&gt;</span>
<span class="nt">&lt;/idea-plugin&gt;</span>
</code></div>


                    <div class="navigation-links _bottom" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/basics/plugin_structure/plugin_icon_file.html">Plugin Logo</a>
                        
                    </div>
                    <div class="last-modified">
                        Last modified: 25 March 2020
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>

<script src="/intellij/sdk/docs/app/app.js" data-baseurl="/intellij/sdk/docs/"></script>

</body>
</html>

