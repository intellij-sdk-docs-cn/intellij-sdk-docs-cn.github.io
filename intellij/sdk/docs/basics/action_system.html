


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>Action System / IntelliJ Platform SDK  DevGuide</title>
    <link rel="stylesheet" href="/intellij/sdk/docs/app/app.css">
    <link rel="shortcut icon" href="/intellij/sdk/docs/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="57x57" href="/intellij/sdk/docs/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/intellij/sdk/docs/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/intellij/sdk/docs/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/intellij/sdk/docs/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/intellij/sdk/docs/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/intellij/sdk/docs/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/intellij/sdk/docs/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/intellij/sdk/docs/apple-touch-icon-180x180.png">
    <link rel="mask-icon" href="/intellij/sdk/docs/apple-mask-icon.svg" color="black">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-square70x70logo" content="/intellij/sdk/docs/mstile-70x70.png">
    <meta name="msapplication-TileImage" content="/intellij/sdk/docs/mstile-144x144.png">
    <meta name="msapplication-square150x150logo" content="/intellij/sdk/docs/mstile-150x150.png">
    <meta name="msapplication-wide310x150logo" content="/intellij/sdk/docs/mstile-310x150.png">
    <meta name="msapplication-square310x310logo" content="/intellij/sdk/docs/mstile-310x310.png">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="Documentation for working with and extending the IntelliJ Platform SDK" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://intellij-sdk-docs-cn.github.io/intellij/sdk/docs//basics/action_system.html" />
    <meta property="og:site_name" content="JetBrains IntelliJ Platform SDK" />
    <meta property="og:title" content="Action System" />
    <meta property="og:description" content="Documentation for working with and extending the IntelliJ Platform SDK" />
    <meta property="og:image" content="https://intellij-sdk-docs-cn.github.io/intellij/sdk/docs/jetbrains.png" />
    <meta property="article:modified_time" content="2020-03-18T15:58:39+08:00" />
    <!-- <meta property="article:section" content="" /> 
    <meta property="article:tag" content="" /> -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@JBPlatform" />
    <meta name="twitter:title" content="Action System" />
    <meta name="twitter:description" content="Documentation for working with and extending the IntelliJ Platform SDK" />
    <meta name="twitter:image" content="https://intellij-sdk-docs-cn.github.io/intellij/sdk/docs/jetbrains.png" />
    <meta class="swiftype" name="product" data-type="string" content="/intellij/sdk/docs/"></meta>
<link  rel="stylesheet" href="/intellij/sdk/docs/app/styles.css"></head>
<body data-id="basics/action_system">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search IntelliJ Platform SDK  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a data-bypass="true" href="//youtrack.jetbrains.com/issues/IJSDK">Send feedback</a></p>
                <p>&copy; 2000&ndash;2020 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>IntelliJ Platform SDK DevGuide</h3>
                
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">
                    <div class="navigation-links _top" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/reference_guide/ui_themes/themes_intro.html">Custom UI Themes</a>
                        <a class="navigation-links__next" href="/basics/settings.html">Settings</a>
                    </div>
                    <a data-bypass="true" href="https://github.com/intellij-sdk-docs-cn/intellij-sdk-docs-cn/edit/master/basics/action_system.md" class="page-link-to-github" target="_blank" title="Edit this page on GitHub">
                        <i class="github-icon"></i>
                        <span class="text">Edit page</span>
                    </a>

                    <h1>Action System</h1>
                    <!-- Copyright 2000-2020 JetBrains s.r.o. and other contributors. Use of this source code is governed by the Apache 2.0 license that can be found in the LICENSE file. -->

<a name="introduction" class="elem-anchor"></a>
<h2>Introduction<a href="#introduction" class="anchor-link"><span></span></a></h2>
<p>The actions system is an extension point that allows plugins to add their items to IntelliJ Platform-based IDE menus and toolbars. 
For example, one of the action classes is responsible for the <strong>File | Open File…</strong> menu item and for the <strong>Open File</strong> toolbar button.</p>

<p>Actions in the IntelliJ Platform require a <a href="#action-implementation"><span>code implementation</span></a> and must be <a href="#registering-actions"><span>registered</span></a> with the IntelliJ Platform. 
The action implementation determines the contexts in which an action is available, and its functionality when selected in the UI. 
Registration determines where an action appears in the IDE UI.
Once implemented and registered, an action receives callbacks from the IntelliJ Platform in response to user gestures.</p>

<p>The <a href="/intellij/sdk/docs/tutorials/action_system/working_with_custom_actions.html"><span>Creating Actions</span></a> tutorial describes the process of adding a custom action to a plugin.
The <a href="/intellij/sdk/docs/tutorials/action_system/grouping_action.html"><span>Grouping Actions</span></a> tutorial demonstrates three types of groups that can contain actions.
The rest of this page is an overview of actions as an extension point.</p>

<ul id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction"><span>Introduction</span></a></li>
  <li><a href="#action-implementation" id="markdown-toc-action-implementation"><span>Action Implementation</span></a>    <ul>
      <li><a href="#principal-implementation-overrides" id="markdown-toc-principal-implementation-overrides"><span>Principal Implementation Overrides</span></a></li>
      <li><a href="#overriding-the-anactionupdate-method" id="markdown-toc-overriding-the-anactionupdate-method"><span>Overriding the AnAction.update Method</span></a>        <ul>
          <li><a href="#determining-the-action-context" id="markdown-toc-determining-the-action-context"><span>Determining the Action Context</span></a></li>
          <li><a href="#enabling-and-setting-visibility-for-an-action" id="markdown-toc-enabling-and-setting-visibility-for-an-action"><span>Enabling and Setting Visibility for an Action</span></a></li>
        </ul>
      </li>
      <li><a href="#overriding-the-anactionactionperformed-method" id="markdown-toc-overriding-the-anactionactionperformed-method"><span>Overriding the AnAction.actionPerformed Method</span></a></li>
      <li><a href="#action-ids" id="markdown-toc-action-ids"><span>Action IDs</span></a></li>
      <li><a href="#grouping-actions" id="markdown-toc-grouping-actions"><span>Grouping Actions</span></a>        <ul>
          <li><a href="#presentation" id="markdown-toc-presentation"><span>Presentation</span></a></li>
          <li><a href="#compact-attribute" id="markdown-toc-compact-attribute"><span>Compact Attribute</span></a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#registering-actions" id="markdown-toc-registering-actions"><span>Registering Actions</span></a>    <ul>
      <li><a href="#registering-actions-in-pluginxml" id="markdown-toc-registering-actions-in-pluginxml"><span>Registering Actions in plugin.xml</span></a>        <ul>
          <li><a href="#setting-the-override-text-element-for-an-action" id="markdown-toc-setting-the-override-text-element-for-an-action"><span>Setting the Override-Text Element for an Action</span></a></li>
          <li><a href="#action-declaration-reference" id="markdown-toc-action-declaration-reference"><span>Action Declaration Reference</span></a></li>
        </ul>
      </li>
      <li><a href="#registering-actions-from-code" id="markdown-toc-registering-actions-from-code"><span>Registering Actions from Code</span></a></li>
    </ul>
  </li>
  <li><a href="#building-ui-from-actions" id="markdown-toc-building-ui-from-actions"><span>Building UI from Actions</span></a></li>
</ul>

<a name="action-implementation" class="elem-anchor"></a>
<h2>Action Implementation<a href="#action-implementation" class="anchor-link"><span></span></a></h2>
<p>An action is a class derived from the abstract class <a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-e2d423f42b53eafd5c625b93149a0ebc7e49756c/platform/editor-ui-api/src/com/intellij/openapi/actionSystem/AnAction.java" data-bypass="yes" target="_blank"><span><code class="code highlight language-text">AnAction</code></span></a>.
The IntelliJ Platform calls methods of an action when a user interacts with a menu item or toolbar button.</p>

<aside class="warning">
  <p> Classes based on <code class="code highlight language-text">AnAction</code> do not have class fields of any kind. This is because an instance of <code class="code highlight language-text">AnAction</code> class
exists for the entire lifetime of the application. If <code class="code highlight language-text">AnAction</code> class uses a field to store data that has a shorter 
lifetime and doesn’t clear this data promptly, the data leaks. For example, any <code class="code highlight language-text">AnAction</code> data that exists 
only within the context of a <code class="code highlight language-text">Project</code> causes the <code class="code highlight language-text">Project</code> to be kept in memory after the user has closed it.</p>
</aside>

<a name="principal-implementation-overrides" class="elem-anchor"></a>
<h3>Principal Implementation Overrides<a href="#principal-implementation-overrides" class="anchor-link"><span></span></a></h3>
<p>Every IntelliJ Platform action should override <code class="code highlight language-text">AnAction.update()</code> and must override <code class="code highlight language-text">AnAction.actionPerformed()</code>.</p>
<ul>
  <li>An action’s method <code class="code highlight language-text">AnAction.update()</code> is called by the IntelliJ Platform framework to update the state of an action.
The state (enabled, visible) of an action determines whether the action is available in the UI of an IDE.
An object of type <a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-e2d423f42b53eafd5c625b93149a0ebc7e49756c/platform/editor-ui-api/src/com/intellij/openapi/actionSystem/AnActionEvent.java" data-bypass="yes" target="_blank"><span><code class="code highlight language-text">AnActionEvent</code></span></a> is passed to this method, and it contains the information about the current context for the action.
Actions are made available by changing state in the <a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-e2d423f42b53eafd5c625b93149a0ebc7e49756c/platform/platform-api/src/com/intellij/ide/presentation/Presentation.java" data-bypass="yes" target="_blank"><span>Presentation</span></a> object associated with the event context.
As explained in <a href="#overriding-the-anactionupdate-method"><span>Overriding the <code class="code highlight language-text">AnAction.update()</code>  Method</span></a>, it is vital <code class="code highlight language-text">update()</code> methods <em>execute quickly</em> and return execution to the IntelliJ Platform.</li>
  <li>An action’s method <code class="code highlight language-text">AnAction.actionPerformed()</code> is called by the IntelliJ Platform if it is available and selected by the user.
This method does the heavy lifting for the action - it contains the code executed when the action gets invoked.
The <code class="code highlight language-text">actionPerformed()</code> method also receives <code class="code highlight language-text">AnActionEvent</code> as a parameter, which is used to access projects, files, selection, etc. 
See <a href="#overriding-the-anactionactionperformed-method"><span>Overriding the <code class="code highlight language-text">AnAction.actionPerformed()</code> Method</span></a> for more information.</li>
</ul>

<p>There are other methods to override in the <code class="code highlight language-text">AnAction</code> class, such as for changing the default <code class="code highlight language-text">Presentation</code> object for the action.
There is also a use case for overriding action constructors when registering them with dynamic action groups, which is demonstrated in the <a href="/intellij/sdk/docs/tutorials/action_system/grouping_action.html#adding-child-actions-to-the-dynamic-group"><span>Grouping Actions</span></a> tutorial. 
However, the <code class="code highlight language-text">update()</code> and <code class="code highlight language-text">actionPerformed()</code> methods are essential to basic operation.</p>

<a name="overriding-the-anactionupdate-method" class="elem-anchor"></a>
<h3>Overriding the AnAction.update Method<a href="#overriding-the-anactionupdate-method" class="anchor-link"><span></span></a></h3>
<p>The method <code class="code highlight language-text">AnAction.update()</code> is periodically called by the IntelliJ Platform in response to user gestures.
The <code class="code highlight language-text">update()</code> method gives an action to evaluate the current context and enable or disable its functionality.</p>

<aside class="warning">
  <p> The <code class="code highlight language-text">AnAction.update()</code> method can be called frequently, and on a UI thread.
This method needs to <em>execute very quickly</em>; no real work should be performed in this method.
For example, checking selection in a tree or a list is considered valid, but working with the file system is not.</p>
</aside>

<aside class="tip">
  <p> If the new state of an action cannot be determined quickly, then evaluation should be performed in the <code class="code highlight language-text">AnAction.actionPerformed()</code> method, and notify the user that the action cannot be executed if the context isn’t suitable.</p>
</aside>

<a name="determining-the-action-context" class="elem-anchor"></a>
<h4>Determining the Action Context</h4>
<p>The <code class="code highlight language-text">AnActionEvent</code> object passed to <code class="code highlight language-text">update()</code> carries information about the current context for the action.
Context information is available from the methods of <code class="code highlight language-text">AnActionEvent</code>, providing information such as the Presentation, and whether the action is triggered from a Toolbar.
Additional context information is available using the method <code class="code highlight language-text">AnActionEvent.getData()</code>. 
Keys defined in <a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-e2d423f42b53eafd5c625b93149a0ebc7e49756c/platform/editor-ui-api/src/com/intellij/openapi/actionSystem/CommonDataKeys.java" data-bypass="yes" target="_blank"><span><code class="code highlight language-text">CommonDataKeys</code></span></a> are passed to the <code class="code highlight language-text">getData()</code> method to retrieve objects such as <code class="code highlight language-text">Project</code>, <code class="code highlight language-text">Editor</code>, <code class="code highlight language-text">PsiFile</code>, and other information.
Accessing this information is relatively light-weight and is suited for <code class="code highlight language-text">AnAction.update()</code>.</p>

<a name="enabling-and-setting-visibility-for-an-action" class="elem-anchor"></a>
<h4>Enabling and Setting Visibility for an Action</h4>
<p>Based on information about the action context, the <code class="code highlight language-text">AnAction.update()</code> method can enable, disable, or hide an action.
An action’s enable/disable state and visibility are set using methods of the <code class="code highlight language-text">Presentation</code> object, which is accessed using <code class="code highlight language-text">AnActionEvent.getPresentation()</code>.</p>

<p>The default <code class="code highlight language-text">Presentation</code> object is a set of descriptive information about a menu or toolbar action.
Every context for an action - it might appear in multiple menus, toolbars, or Navigation search locations - has a unique presentation. 
Attributes such as an action’s text, description, and icons, as well as visibility and enable/disable state, are stored in the presentation.
The attributes in a presentation get initialized from the <a href="#registering-actions"><span>action registration</span></a>.
However, some can be changed at runtime using the methods of the <code class="code highlight language-text">Presentation</code> object associated with an action.</p>

<p>The enabled/disabled state of an action is set using <code class="code highlight language-text">Presentation.setEnabled()</code>.
The visibility state of an action is set using <code class="code highlight language-text">Presentation.setVisible()</code>
If an action is enabled, the <code class="code highlight language-text">AnAction.actionPerformed()</code> can be called if an action is selected in the IDE by a user.
A menu action shows in the UI location specified in the registration.
A toolbar action displays its enabled (or selected) icon, depending on the user interaction.</p>

<p>When an action is disabled <code class="code highlight language-text">AnAction.actionPerformed()</code> will not be called.
Toolbar actions display their respective icons for the disabled state.
The visibility of a disabled action in a menu depends on whether the host menu (e.g. “ToolsMenu”) containing the action has the <code class="code highlight language-text">compact</code> attribute set.
See <a href="#grouping-actions"><span>Grouping Actions</span></a> for more information about the <code class="code highlight language-text">compact</code> attribute, and the visibility of menu actions.</p>

<aside class="note">
  <p> If an action is added to a toolbar, its <code class="code highlight language-text">update()</code> can be called if there was any user activity or focus transfer. 
If the action’s availability changes in the absence of these events, then call <a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-e2d423f42b53eafd5c625b93149a0ebc7e49756c/platform/platform-api/src/com/intellij/ide/ActivityTracker.java" data-bypass="yes" target="_blank"><span><code class="code highlight language-text">ActivityTracker.getInstance().inc()</code></span></a> to notify the action subsystem to update all toolbar actions.</p>
</aside>

<p>An example of enabling a menu action based on whether a project is open is demonstrated in <a href="https://github.com/JetBrains/intellij-sdk-docs/blob/master/code_samples/action_basics/src/main/java/org/intellij/sdk/action/PopupDialogAction.java" data-bypass="yes" target="_blank"><span><code class="code highlight language-text">PopupDialogAction.update()</code></span></a> method.</p>

<a name="overriding-the-anactionactionperformed-method" class="elem-anchor"></a>
<h3>Overriding the AnAction.actionPerformed Method<a href="#overriding-the-anactionactionperformed-method" class="anchor-link"><span></span></a></h3>
<p>When the user selects an enabled action, be it from a menu or toolbar, the action’s <code class="code highlight language-text">AnAction.actionPerformed()</code> method is called. 
This method contains the code executed to perform the action, and it is here that the real work gets done.</p>

<p>Using the <code class="code highlight language-text">AnActionEvent</code> methods and <code class="code highlight language-text">CommonDataKeys</code>, objects such as the <code class="code highlight language-text">Project</code>, <code class="code highlight language-text">Editor</code>, <code class="code highlight language-text">PsiFile</code>, and other information is available.
For example, the <code class="code highlight language-text">actionPerformed()</code> method can modify, remove, or add PSI elements to a file open in the editor.</p>

<p>The code that executes in the <code class="code highlight language-text">AnAction.actionPerformed()</code> method should execute efficiently, but it does not have to meet the same stringent requirements as the <code class="code highlight language-text">update()</code> method.</p>

<!-- TODO: does this all happen inside a transaction? Does that ensure the undo step? -->

<p>An example of inspecting PSI elements is demonstrated in the SDK code sample <code class="code highlight language-text">action_basics</code> <a href="https://github.com/JetBrains/intellij-sdk-docs/blob/master/code_samples/action_basics/src/main/java/org/intellij/sdk/action/PopupDialogAction.java" data-bypass="yes" target="_blank"><span><code class="code highlight language-text">PopupDialogAction.actionPerformed()</code></span></a> method.</p>

<a name="action-ids" class="elem-anchor"></a>
<h3>Action IDs<a href="#action-ids" class="anchor-link"><span></span></a></h3>
<p>Every action and action group has a unique identifier.
Basing the identifier for a custom action on the FQN of the implementation is the best practice, assuming the package incorporates the <code class="code highlight language-text">&lt;id&gt;</code> of the plugin.
An action must have a unique identifier for each place it is used in the IDE UI, even though the FQN of the implementation is the same.
Definitions of identifiers for the standard IntelliJ Platform actions are in <a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-e2d423f42b53eafd5c625b93149a0ebc7e49756c/platform/platform-api/src/com/intellij/openapi/actionSystem/IdeActions.java" data-bypass="yes" target="_blank"><span><code class="code highlight language-text">IdeActions</code></span></a>.</p>

<a name="grouping-actions" class="elem-anchor"></a>
<h3>Grouping Actions<a href="#grouping-actions" class="anchor-link"><span></span></a></h3>
<p>Groups organize actions into logical UI structures, which in turn can contain other groups. 
A group of actions can form a toolbar or a menu.
Subgroups of a group can form submenus of a menu.</p>

<p>Actions can be included in multiple groups, and thus appear in multiple places within the IDE UI. 
An action must have a unique identifier for each place it appears in the IDE UI.
See the <a href="#action-declaration-reference"><span>Action Declaration Reference</span></a> section for information about how to specify locations in the IDE UI.</p>

<!-- TODO: Reconcile ActionPlaces vs. PlatformActions -->

<a name="presentation" class="elem-anchor"></a>
<h4>Presentation</h4>
<p>For every place where the action appears, a new <a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-e2d423f42b53eafd5c625b93149a0ebc7e49756c/platform/platform-api/src/com/intellij/ide/presentation/Presentation.java" data-bypass="yes" target="_blank"><span><code class="code highlight language-text">Presentation</code></span></a> is created. 
Therefore the same action can have different text or icons when it appears in different places of the user interface. 
Different presentations for the action are created by copying the Presentation returned by the <code class="code highlight language-text">AnAction.getTemplatePresentation()</code> method.</p>

<a name="compact-attribute" class="elem-anchor"></a>
<h4>Compact Attribute</h4>
<p>A group’s “compact” attribute specifies whether an action within that group is visible when disabled.
See <a href="#registering-actions-in-pluginxml"><span>Registering Actions in plugin.xml</span></a> for an explanation of how the <code class="code highlight language-text">compact</code> attribute is set for a group.
If the <code class="code highlight language-text">compact</code> attribute is <code class="code highlight language-text">true</code> for a menu group, an action in the menu only appears if its state is both enabled and visible.
In contrast, if the <code class="code highlight language-text">compact</code> attribute is <code class="code highlight language-text">false</code>, an action in the menu appears if its state is disabled but visible.
Some menus like <strong>Tools</strong> have the <code class="code highlight language-text">compact</code> attribute set, so there isn’t a way to show an action on the tools menu if it is not enabled.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Host Menu<br /><code class="code highlight language-text">compact</code> Setting</th>
      <th style="text-align: center">Action Enabled</th>
      <th style="text-align: center">Visibility Enabled</th>
      <th style="text-align: center">Menu Item Visible?</th>
      <th style="text-align: center">Menu Item Appears Gray?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">T</td>
      <td style="text-align: center"><strong>F</strong></td>
      <td style="text-align: center">T</td>
      <td style="text-align: center"><strong>F</strong></td>
      <td style="text-align: center">N/A</td>
    </tr>
    <tr>
      <td style="text-align: center">T</td>
      <td style="text-align: center">T</td>
      <td style="text-align: center">T</td>
      <td style="text-align: center">T</td>
      <td style="text-align: center">F</td>
    </tr>
    <tr>
      <td style="text-align: center">F</td>
      <td style="text-align: center"><strong>F</strong></td>
      <td style="text-align: center">T</td>
      <td style="text-align: center"><strong>T</strong></td>
      <td style="text-align: center"><strong>T</strong></td>
    </tr>
    <tr>
      <td style="text-align: center">F</td>
      <td style="text-align: center">T</td>
      <td style="text-align: center">T</td>
      <td style="text-align: center">T</td>
      <td style="text-align: center">F</td>
    </tr>
  </tbody>
</table>

<p>All other combinations of <code class="code highlight language-text">compact</code>, visibility, and enablement produce N/A for gray appearance because the menu item isn’t visible.</p>

<p>See the <a href="/intellij/sdk/docs/tutorials/action_system/grouping_action.html"><span>Grouping Actions</span></a> tutorial for examples of creating action groups.</p>

<a name="registering-actions" class="elem-anchor"></a>
<h2>Registering Actions<a href="#registering-actions" class="anchor-link"><span></span></a></h2>
<p>There are two main ways to register an action: either by listing it in the <code class="code highlight language-text">&lt;actions&gt;</code> section of a plugin’s <code class="code highlight language-text">plugin.xml</code> file, or through code.</p>

<a name="registering-actions-in-pluginxml" class="elem-anchor"></a>
<h3>Registering Actions in plugin.xml<a href="#registering-actions-in-pluginxml" class="anchor-link"><span></span></a></h3>
<p>Registering actions in <code class="code highlight language-text">plugin.xml</code> is demonstrated in the following reference examples, which document all elements and attributes that can be used in the <code class="code highlight language-text">&lt;actions&gt;</code> section, and describes the meaning of each element.</p>

<a name="setting-the-override-text-element-for-an-action" class="elem-anchor"></a>
<h4>Setting the Override-Text Element for an Action</h4>

<aside class="tip">
  <p> Beginning in 2020.1, an alternate version of an action’s menu text can be declared for use depending on where an action appears.</p>
</aside>

<p>By using the <code class="code highlight language-text">&lt;override-text&gt;</code> element introduced in 2020.1 of the IntelliJ Platform, the menu text for an action can be different depending on context: menu location, toolbar, etc.</p>

<p>In the <code class="code highlight language-text">action</code> element reference example (below) with <code class="code highlight language-text">id</code> attribute <code class="code highlight language-text">VssIntegration.GarbageCollection</code>, the default is to use the menu text “Garbage Collector: Collect _Garbage.”
The <code class="code highlight language-text">add-to-group</code> element declares the action is added to the Tools Menu.</p>

<p>However, the <code class="code highlight language-text">override-text</code> element declares that text for <code class="code highlight language-text">VssIntegration.GarbageCollection</code> displayed anywhere in the Main Menu system should be the alternate text “Collect _Garbage.”
The Tools Menu is part of the Main Menu, so the displayed menu text is “Collect _Garbage.”
A different context, such as searching for the action using <strong>Help | Find Action…</strong>,  displays the default text “Garbage Collector: Collect _Garbage” to give the user additional information about the action.</p>

<p>A second <code class="code highlight language-text">override-text</code> element uses <code class="code highlight language-text">place</code> and <code class="code highlight language-text">use-text-of-place</code> attributes to declare the same version of the text used in the Main Menu is also used in the Editor Popup Menu.
Additional <code class="code highlight language-text">override-text</code> elements could be used to specify additional places where the Main Menu text should be used.</p>

<a name="action-declaration-reference" class="elem-anchor"></a>
<h4>Action Declaration Reference</h4>
<p>The places where actions can appear are defined by constants in <a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-e2d423f42b53eafd5c625b93149a0ebc7e49756c/platform/platform-api/src/com/intellij/openapi/actionSystem/ActionPlaces.java" data-bypass="yes" target="_blank"><span><code class="code highlight language-text">ActionPlaces</code></span></a>. 
Group IDs for the IntelliJ Platform are defined in <a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-e2d423f42b53eafd5c625b93149a0ebc7e49756c/platform/platform-resources/src/idea/PlatformActions.xml" data-bypass="yes" target="_blank"><span>PlatformActions</span></a>.</p>

<p>This, and additional information can also be found by using the <a href="https://www.jetbrains.com/help/idea/auto-completing-code.html#invoke-basic-completion" data-bypass="yes" target="_blank"><span>Code Completion</span></a>, <a href="https://www.jetbrains.com/help/idea/viewing-reference-information.html#view-definition-symbols" data-bypass="yes" target="_blank"><span>Quick Definition</span></a> and <a href="https://www.jetbrains.com/help/idea/viewing-reference-information.html#inline-quick-documentation" data-bypass="yes" target="_blank"><span>Quick Documentation</span></a> features.</p>

<div class="code-block" data-lang="xml"><code class="code-block__wrapper"><span class="c">&lt;!-- Actions --&gt;</span>
<span class="nt">&lt;actions&gt;</span>
  <span class="c">&lt;!-- The &lt;action&gt; element defines an action to register.
       The mandatory "id" attribute specifies a unique 
       identifier for the action.
       The mandatory "class" attribute specifies the
       FQN of the class implementing the action.
       The mandatory "text" attribute specifies the default long-version text to be displayed for the
       action (tooltip for toolbar button or text for menu item).
       The optional "use-shortcut-of" attribute specifies the ID
       of the action whose keyboard shortcut this action will use.
       The optional "description" attribute specifies the text
       which is displayed in the status bar when the action is focused.
       The optional "icon" attribute specifies the icon which is
       displayed on the toolbar button or next to the menu item. --&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">id=</span><span class="s">"VssIntegration.GarbageCollection"</span> <span class="na">class=</span><span class="s">"com.foo.impl.CollectGarbage"</span> <span class="na">text=</span><span class="s">"Garbage Collector: Collect _Garbage"</span> 
                <span class="na">description=</span><span class="s">"Run garbage collector"</span> <span class="na">icon=</span><span class="s">"icons/garbage.png"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- The &lt;override-text&gt; element defines an alternate version of the text for the menu action.
         The mandatory "text" attribute defines the text to be displayed for the action.
         The mandatory "place" attribute declares where the alternate text should be used. In this example,
         any time the action is displayed in the IDE Main Menu (and submenus) the override-text
         version should be used.  
         The second &lt;override-text&gt; element uses the alternate attribute "use-text-of-place" to define
         a location (EditorPopup) to use the same text as is used in MainMenu. It is a way to specify 
         use of alternate menu text in multiple discrete menu groups. --&gt;</span>
    <span class="nt">&lt;override-text</span> <span class="na">place=</span><span class="s">"MainMenu"</span> <span class="na">text=</span><span class="s">"Collect _Garbage"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;override-text</span> <span class="na">place=</span><span class="s">"EditorPopup"</span> <span class="na">use-text-of-place=</span><span class="s">"MainMenu"</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- The &lt;add-to-group&gt; node specifies that the action should be added
         to an existing group. An action can be added to several groups.
         The mandatory "group-id" attribute specifies the ID of the group
         to which the action is added.
         The group must be implemented by an instance of the DefaultActionGroup class.
         The mandatory "anchor" attribute specifies the position of the
         action in the group relative to other actions. It can have the values
         "first", "last", "before" and "after".
         The "relative-to-action" attribute is mandatory if the anchor
         is set to "before" and "after", and specifies the action before or after which
         the current action is inserted. --&gt;</span>
    <span class="nt">&lt;add-to-group</span> <span class="na">group-id=</span><span class="s">"ToolsMenu"</span> <span class="na">relative-to-action=</span><span class="s">"GenerateJavadoc"</span> <span class="na">anchor=</span><span class="s">"after"</span><span class="nt">/&gt;</span>
      <span class="c">&lt;!-- The &lt;keyboard-shortcut&gt; node specifies the keyboard shortcut
           for the action. An action can have several keyboard shortcuts.
           The mandatory "first-keystroke" attribute specifies the first
           keystroke of the action. The keystrokes are specified according
           to the regular Swing rules.
           The optional "second-keystroke" attribute specifies the second
           keystroke of the action.
           The mandatory "keymap" attribute specifies the keymap for which
           the action is active. IDs of the standard keymaps are defined as
           constants in the com.intellij.openapi.keymap.KeymapManager class. 
           The optional "remove" attribute in the second &lt;keyboard-shortcut&gt;
           element below means the specified shortcut should be removed from 
           the specified action.
           The optional "replace-all" attribute in the third &lt;keyboard-shortcut&gt;
           element below means remove all keyboard and mouse shortcuts from the specified 
           action before adding the specified shortcut.  --&gt;</span>
    <span class="c">&lt;!-- Add the first and second keystrokes to all keymaps  --&gt;</span>
    <span class="nt">&lt;keyboard-shortcut</span> <span class="na">keymap=</span><span class="s">"$default"</span> <span class="na">first-keystroke=</span><span class="s">"control alt G"</span> <span class="na">second-keystroke=</span><span class="s">"C"</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- Except to the "Mac OS X" keymap and its children --&gt;</span>
    <span class="nt">&lt;keyboard-shortcut</span> <span class="na">keymap=</span><span class="s">"Mac OS X"</span> <span class="na">first-keystroke=</span><span class="s">"control alt G"</span> <span class="na">second-keystroke=</span><span class="s">"C"</span> <span class="na">remove=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- The "Mac OS X 10.5+" keymap and its children will have only this keyboard shortcut for this action.  --&gt;</span>
    <span class="nt">&lt;keyboard-shortcut</span> <span class="na">keymap=</span><span class="s">"Mac OS X 10.5+"</span> <span class="na">first-keystroke=</span><span class="s">"control alt G"</span> <span class="na">second-keystroke=</span><span class="s">"C"</span> <span class="na">replace-all=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- The &lt;mouse-shortcut&gt; node specifies the mouse shortcut for the
           action. An action can have several mouse shortcuts.
           The mandatory "keystroke" attribute specifies the clicks and
           modifiers for the action. It is defined as a sequence of words
           separated by spaces: 
           "button1", "button2", "button3" for the mouse buttons;
           "shift", "control", "meta", "alt", "altGraph" for the modifier keys;
           "doubleClick" if the action is activated by a double-click of the button.
           The mandatory "keymap" attribute specifies the keymap for which
           the action is active. IDs of the standard keymaps are defined as
           constants in the com.intellij.openapi.keymap.KeymapManager class.
           The "remove" and "replace-all" attributes can also be used in
           a &lt;mouse-shortcut&gt; element. See &lt;keyboard-shortcut&gt; for documentation.  --&gt;</span>
    <span class="nt">&lt;mouse-shortcut</span> <span class="na">keymap=</span><span class="s">"$default"</span> <span class="na">keystroke=</span><span class="s">"control button3 doubleClick"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
  <span class="c">&lt;!-- The &lt;group&gt; element defines an action group. &lt;action&gt;, &lt;group&gt; and 
       &lt;separator&gt; elements defined within it are automatically included in the group.
       The mandatory "id" attribute specifies a unique identifier for the action.
       The optional "class" attribute specifies the FQN of
       the class implementing the group. If not specified,
       com.intellij.openapi.actionSystem.DefaultActionGroup is used.
       The optional "text" attribute specifies the text of the group (text
       for the menu item showing the submenu).
       The optional "description" attribute specifies the text which is displayed
       in the status bar when the group has focus.
       The optional "icon" attribute specifies the icon which is displayed on
       the toolbar button or next to the menu group.
       The optional "popup" attribute specifies how the group is presented in
       the menu. If a group has popup="true", actions in it are placed in a
       submenu; for popup="false", actions are displayed as a section of the
       same menu delimited by separators. 
       The optional "compact" attribute specifies whether an action within that group is visible when disabled.
       Setting compact="true" specifies an action in the group isn't visible unless the action is enabled.        --&gt;</span>
  <span class="nt">&lt;group</span> <span class="na">class=</span><span class="s">"com.foo.impl.MyActionGroup"</span> <span class="na">id=</span><span class="s">"TestActionGroup"</span> <span class="na">text=</span><span class="s">"Test Group"</span> <span class="na">description=</span><span class="s">"Group with test actions"</span> <span class="na">icon=</span><span class="s">"icons/testgroup.png"</span> <span class="na">popup=</span><span class="s">"true"</span> <span class="na">compact=</span><span class="s">"true"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;action</span> <span class="na">id=</span><span class="s">"VssIntegration.TestAction"</span> <span class="na">class=</span><span class="s">"com.foo.impl.TestAction"</span> <span class="na">text=</span><span class="s">"My Test Action"</span> <span class="na">description=</span><span class="s">"My test action"</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- The &lt;separator&gt; element defines a separator between actions.
         It can also have an &lt;add-to-group&gt; child element. --&gt;</span>
    <span class="nt">&lt;separator/&gt;</span>
    <span class="nt">&lt;group</span> <span class="na">id=</span><span class="s">"TestActionSubGroup"</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- The &lt;reference&gt; element allows to add an existing action to the group.
         The mandatory "ref" attribute specifies the ID of the action to add. --&gt;</span>
    <span class="nt">&lt;reference</span> <span class="na">ref=</span><span class="s">"EditorCopy"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;add-to-group</span> <span class="na">group-id=</span><span class="s">"MainMenu"</span> <span class="na">relative-to-action=</span><span class="s">"HelpMenu"</span> <span class="na">anchor=</span><span class="s">"before"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/group&gt;</span>
<span class="nt">&lt;/actions&gt;</span>
</code></div>

<a name="registering-actions-from-code" class="elem-anchor"></a>
<h3>Registering Actions from Code<a href="#registering-actions-from-code" class="anchor-link"><span></span></a></h3>
<p>Two steps are required to register an action from code:</p>
<ul>
  <li>First, an instance of the class derived from <code class="code highlight language-text">AnAction</code> must be passed to the <code class="code highlight language-text">registerAction()</code> method of <a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-e2d423f42b53eafd5c625b93149a0ebc7e49756c/platform/editor-ui-api/src/com/intellij/openapi/actionSystem/ActionManager.java" data-bypass="yes" target="_blank"><span><code class="code highlight language-text">ActionManager</code></span></a>, to associate the action with an ID.</li>
  <li>Second, the action needs to be added to one or more groups. 
To get an instance of an action group by ID, it is necessary to call <code class="code highlight language-text">ActionManager.getAction()</code> and cast the returned value to <a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-e2d423f42b53eafd5c625b93149a0ebc7e49756c/platform/platform-api/src/com/intellij/openapi/actionSystem/DefaultActionGroup.java" data-bypass="yes" target="_blank"><span><code class="code highlight language-text">DefaultActionGroup</code></span></a>.</li>
</ul>

<a name="building-ui-from-actions" class="elem-anchor"></a>
<h2>Building UI from Actions<a href="#building-ui-from-actions" class="anchor-link"><span></span></a></h2>
<p>If a plugin needs to include a toolbar or popup menu built from a group of actions in its user interface, that is accomplished through <a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-e2d423f42b53eafd5c625b93149a0ebc7e49756c/platform/editor-ui-api/src/com/intellij/openapi/actionSystem/ActionPopupMenu.java" data-bypass="yes" target="_blank"><span><code class="code highlight language-text">ActionPopupMenu</code></span></a> and <a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-e2d423f42b53eafd5c625b93149a0ebc7e49756c/platform/editor-ui-api/src/com/intellij/openapi/actionSystem/ActionToolbar.java" data-bypass="yes" target="_blank"><span><code class="code highlight language-text">ActionToolbar</code></span></a>. 
These objects can be created through calls to the <code class="code highlight language-text">ActionManager.createActionPopupMenu()</code> and <code class="code highlight language-text">createActionToolbar()</code> methods. 
To get a Swing component from such an object, call the respective <code class="code highlight language-text">getComponent()</code> method.</p>

<p>If an action toolbar is attached to a specific component (for example, a panel in a tool window), call <code class="code highlight language-text">ActionToolbar.setTargetComponent()</code> and pass the instance of the related component as a parameter. 
Setting the target ensures that the state of the toolbar buttons depends on the state of the related component, and not on the current focus location within the IDE frame.</p>


                    <div class="navigation-links _bottom" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/reference_guide/ui_themes/themes_intro.html">Custom UI Themes</a>
                        <a class="navigation-links__next" href="/basics/settings.html">Settings</a>
                    </div>
                    <div class="last-modified">
                        Last modified: 18 March 2020
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>

<script src="/intellij/sdk/docs/app/app.js" data-baseurl="/intellij/sdk/docs/"></script>

</body>
</html>

